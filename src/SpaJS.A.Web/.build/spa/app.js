var app;!function(t){"use strict";var e=function(){function t(t,e,o){t.when("/",{templateUrl:"/app/templates/customers/customersView.html",controller:"customersCtrl as vm"}).when("/about",{templateUrl:"/app/templates/about.html"}).otherwise({redirectTo:"/"})}return t}();t.Config=e;var o=angular.module("sampleAngularApp",["ngAnimate","ngCookies","ngRoute","ui.bootstrap","ui.bootstrap.tpls"]);o.config(e),e.$inject=["$routeProvider","$httpProvider"]}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){var o=function(){function t(){this.appTitle="Sample Spa App: Customer Interactions With Promises",this.baseUri="http://localhost:5196",this.postUri="/api/customers/"}return t}();e.ConstantsService=o,angular.module("sampleAngularApp").service("constantsService",t.services.common.ConstantsService)}(o=e.common||(e.common={}))}(e=t.services||(t.services={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){var o=function(){function t(t,e){this._httpService=t,this._qService=e}return t.prototype.get=function(t,e){function o(){var e=r._qService.defer();return r._httpService.get(t).then(function(t){JSON.stringify(t.data),e.resolve(t.data)},function(t){e.reject(t)}),e.promise}var r=this;return o()},t.prototype.getSingle=function(t){var e=this,o=e._qService.defer();return e._httpService.get(t).then(function(t){o.resolve(t.data)},function(t){o.reject(t)}),o.promise},t.prototype.add=function(t,e){var o=this,r=o._qService.defer();return o._httpService.post(t,e).then(function(t){r.resolve(t.data)},function(t){r.reject(t)}),r.promise},t.prototype.update=function(t,e){var o=this,r=o._qService.defer();return o._httpService.put(t,e).then(function(t){r.resolve(t)},function(t){r.reject(t)}),r.promise},t.prototype.remove=function(t){var e=this,o=e._qService.defer();return e._httpService["delete"](t).then(function(t){o.resolve(t)},function(t){o.reject(t)}),o.promise},t.$inject=["$http","$q"],t}();e.DataService=o,angular.module("sampleAngularApp").service("dataService",t.services.common.DataService)}(o=e.common||(e.common={}))}(e=t.services||(t.services={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){"use strict";var o=function(){function t(t,e,o,r,n,s){this._$http=o,this._$q=t,this._errorHandler=n,this._tokenHandler=s,this._url=r.baseUri+r.postUri}return t.prototype.registerUser=function(t){var e=this,o=e._$q.defer();return e._$http({url:e._url,method:"POST",data:t}).then(function(t){o.resolve(t)},function(t){o.reject(t)}),o.promise},t.prototype.logInUser=function(t){var e=this,o=e._$q.defer(),r="username="+t.Username+"&password="+t.Password+"&grant_type=password",n=e._url+"token";return e._$http({url:n,method:"POST",data:r,withCredentials:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){e._tokenHandler.setLoginToken(t.access_token),e._tokenHandler.setLoginName(t.userName),o.resolve(t)},function(t){e.logOutUser(),o.reject(t)}),o.promise},t.prototype.logOutUser=function(){var t=this,e=t._url,o=t._$q.defer();return t._$http({url:e,method:"POST"}).then(function(e){t._tokenHandler.removeLoginToken(),o.resolve(e.data)},function(e){t.logOutUser(),o.reject(e)}),o.promise},t.prototype.userIsAuthenticated=function(){var t=this;return t._tokenHandler.hasLoginToken()},t.$inject=["$q","$window","$http","constantsService","errorHandler","tokenHandler"],t}();e.UserAccountService=o,angular.module("sampleAngularApp").controller("userAccountService",t.services.accounts.UserAccountService)}(o=e.accounts||(e.accounts={}))}(e=t.services||(t.services={}))}(app||(app={}));var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},app;!function(t){var e;!function(e){var o=function(t){function e(e,o,r,n,s,i,a){t.call(this),this.AddressLine1=e,this.AddressLine2=o,this.AddressLine3=r,this.AddressLine4=n,this.Email=s,this.Postcode=i,this.AddressId=a,this.AddressId=a,this.AddressLine1=e,this.AddressLine2=o,this.AddressLine3=r,this.AddressLine4=n,this.Email=s,this.Postcode=i}return __extends(e,t),e}(t.domain.EntityBase);e.Address=o}(e=t.domain||(t.domain={}))}(app||(app={}));var __extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},app;!function(t){var e;!function(e){var o=function(t){function e(e,o,r,n,s){t.call(this),this.FirstName=e,this.Surname=o,this.Active=r,this.Address=n,this.CustomerId=s,this.CustomerId=s,this.FirstName=e,this.Surname=o,this.Active=r,this.Address=n}return __extends(e,t),e}(t.domain.EntityBase);e.Customer=o}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e=function(){function t(){}return t}();t.EntityBase=e}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict"}(e=t.common||(t.common={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t,e){this.Success=t,this.Description=e}return t}();t.Message=e}(e=t.common||(t.common={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict"}(e=t.accounts||(t.accounts={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict"}(e=t.accounts||(t.accounts={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t,e){this.Username=t,this.Password=e}return t}();t.loginData=e}(e=t.accounts||(t.accounts={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){"use strict";var e=function(){function t(t,e,o,r,n){this.FirstName=t,this.Surname=e,this.Email=o,this.UserName=r,this.Password=n}return t}();t.registrationData=e}(e=t.accounts||(t.accounts={}))}(e=t.domain||(t.domain={}))}(app||(app={}));var app;!function(t){var e;!function(t){var e;!function(t){var e=function(){function t(t,e,o){this.$location=t,this.constantsService=e,this.dataService=o;var r=this;r.resource=r.constantsService.baseUri+this.constantsService.postUri}return t.prototype.add=function(){var t=this,e=this.constantsService.baseUri+this.constantsService.postUri;this.dataService.add(e,this.customer).then(function(e){alert(e.CustomerId+" submitted successfully"),t.$location.path("/")})},t.$inject=["$location","constantsService","dataService"],t}();angular.module("sampleAngularApp").controller("customerAddCtrl",e)}(e=t.customers||(t.customers={}))}(e=t.controllers||(t.controllers={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){var o=function(){function t(t,e,o){this.$scope=t,this.$modalInstance=e,this.customer=o,this.modalCustomer=o}return t.prototype.ok=function(){this.$modalInstance.close(this.modalCustomer)},t.prototype.cancel=function(){this.$modalInstance.dismiss("cancel")},t.controllerId="customerModalCtrl",t.$inject=["$scope","$modalInstance","customer"],t}();e.CustomerModalCtrl=o,angular.module("sampleAngularApp").controller("customerModalCtrl",t.controllers.customers.CustomerModalCtrl)}(o=e.customers||(e.customers={}))}(e=t.controllers||(t.controllers={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){var o=function(){function t(t,e,o,r){this.$scope=t,this.constantsService=e,this.dataService=o,this.$modal=r;var n=this;this.resource=e.baseUri+e.postUri,n.page=0,n.pagesCount=5,n.totalCount=0,this.scope=t,n.Customers=[],n.getCustomers(!0)}return t.prototype.search=function(){},t.prototype.refresh=function(){alert("length:"+this.Customers.length),this.getCustomers(!0)},t.prototype.getCustomers=function(t){var e=this,o=this;this.loadingCustomers=!0,this.dataService.get(this.resource,t).then(function(t){if(0==e.Customers.length)e.Customers=t;else{if(null!=t)for(var r=0;r<t.length;r++)o.Customers[r].CustomerId==t[r].CustomerId?o.Customers[r]=t[r]:o.Customers.push(t[r]);e.loadingCustomers=!1,e.totalCount=o.Customers.length,alert("retreived:"+o.Customers.length)}})},t.prototype.getCustomersById=function(t){var e=this;this.dataService.getSingle(this.resource+t).then(function(t){e.customer=t})},t.prototype.saveCustomer=function(t){var e=this;this.dataService.add(this.resource,t).then(function(o){e.Customers.push(t),e.getCustomers(!0)},function(t){console.log(t)})},t.prototype.updateCustomer=function(t){var e=this;this.dataService.update(this.resource,t).then(function(t){},function(t){e.getCustomers(!0),console.log(t)})},t.prototype.deleteCustomer=function(t){var e=this;this.dataService.remove(this.resource+t).then(function(o){for(var r=0;r<e.Customers.length;r++)if(e.Customers[r].CustomerId==t)return void e.Customers.splice(r,1);e.getCustomers(!0)})},t.prototype.remove=function(t){var e=this;confirm("Are you sure you want to delete this customer?")&&(e.deleteCustomer(t),e.getCustomers(!0))},t.prototype.add=function(){var t=this,e=this,o={animation:!0,templateUrl:"app/templates/customers/addCustomerView.html",controller:"customerModalCtrl",controllerAs:"modal",size:"lg",backdrop:"static",resolve:{customer:function(){return t.customer}}};this.$modal.open(o).result.then(function(t){null!=t&&(e.saveCustomer(t),e.getCustomers(!0))},function(t){})},t.prototype.edit=function(t){var e=this,o={animation:!0,templateUrl:"app/templates/customers/addCustomerView.html",controller:"customerModalCtrl",controllerAs:"modal",size:"lg",backdrop:"static",resolve:{customer:function(){return t}}};this.$modal.open(o).result.then(function(t){null!=t&&e.updateCustomer(t)})},t.$inject=["$scope","constantsService","dataService","$modal"],t}();e.CustomersCtrl=o,angular.module("sampleAngularApp").controller("customersCtrl",t.controllers.customers.CustomersCtrl)}(o=e.customers||(e.customers={}))}(e=t.controllers||(t.controllers={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){"use strict";var o=function(){function e(e,o,r){this.$scope=e,this.$location=o,this.userAccountService=r,this._$scope=e,this._loginData=new t.domain.accounts.loginData("","")}return e.prototype.login=function(){var t=this;t._userAccountService.logInUser(t._loginData).then(function(e){t.$scope.Global.userIsAuthenticated=!0,t._$location.path("/")},function(e){t._$scope.message=e.error_description})},e.$inject=["$scope","$location","UserAccountService"],e}();e.LoginCtrl=o,angular.module("sampleAngularApp").controller("loginCtrl",t.controllers.accounts.LoginCtrl)}(o=e.accounts||(e.accounts={}))}(e=t.controllers||(t.controllers={}))}(app||(app={}));var app;!function(t){var e;!function(e){var o;!function(e){"use strict";var o=function(){function e(e,o,r,n){this.$scope=e,this.$location=o,this.$timeout=r,this.userAccountService=n,this._$scope=e,this._$location=o,this._userAccountService=n,this._$scope.savedSuccessfully=!1,this._$scope.message=new t.domain.common.Message(!1,""),this._$scope.registrationData=new t.domain.accounts.registrationData("","","","","")}return e.prototype.register=function(){var e=this,o=e._$scope.registrationData;e._userAccountService.registerUser(o).then(function(o){e._$scope.savedSuccessfully=!0,e._$scope.message=new t.domain.common.Message(!0,"Registered successfully, you will be redicted to login page shortly"),e.startTimer()},function(o){var r;for(var n in o.data)for(var s=0;s<o.data.modelState[n].length;s++)r.push(o.data.modelState[n][s]);e._$scope.message=new t.domain.common.Message(!1,"Failed to register user : "+r.join(" "))})},e.prototype.startTimer=function(){var t=this,e=t.$timeout(function(){t.$timeout.cancel(e),t.$location.path("/Account/Login")},2e3)},e.$inject=["$scope","$location","$timeout","UserAccountService"],e}();e.RegisterUserCtrl=o,angular.module("sampleAngularApp").controller("registerUserCtrl",t.controllers.accounts.RegisterUserCtrl)}(o=e.accounts||(e.accounts={}))}(e=t.controllers||(t.controllers={}))}(app||(app={}));